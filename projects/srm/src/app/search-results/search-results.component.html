<div class='trigger' [class.visible]='triggerVisible'></div>
<div class='counts' *ngIf='hasCounts'>
    <div class='line' *ngIf='totalCount > 0'>
        <span class='strong'>{{visibleCount.toLocaleString()}} תוצאות על המפה</span>
        <span>מתוך {{totalCount.toLocaleString()}} <a (click)='zoomout.emit()'>בכל הארץ</a></span>    
    </div>
    <span *ngIf='visibleCount === 0 && totalCount === 0'>לא נמצאו תוצאות בכל הארץ, מומלץ <a href="/q">לשנות את החיפוש</a></span>
</div>
<ng-container *ngFor='let result of results; let i=index'>
    <ng-container *ngIf='!!result'>
        <a [routerLink]='["c", result.card_id]' [queryParamsHandling]='"merge"' *ngIf='!result._collapse_count'>
            <app-result-stack [result]='result'></app-result-stack>
        </a>
        <a (click)='expand(i)' *ngIf='!!result._collapse_count'>
            <app-result-stack [result]='result' *ngIf='!!result._collapse_count'></app-result-stack>
        </a>
    </ng-container>
</ng-container>
<ng-container *ngIf='loading'>
    <ng-container *ngIf='!results.length'>
        <div class='placeholder loading'></div>
        <div class='placeholder loading'></div>
        <div class='placeholder loading'></div>
    </ng-container>
    <ng-container *ngIf='results.length'>
        <div class='placeholder loading'></div>
    </ng-container>
</ng-container>
<div class='trigger' [class.visible]='triggerVisible' #trigger></div>