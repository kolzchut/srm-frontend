<ng-container *ngIf='!active'>
    <button class='open-modal' [class.active]='!!totalFilters' (click)='active = true' aria-label='Open Filtering Bar'>
        <img *ngIf='!totalFilters' src='assets/img/icon-filter-gray-3.svg' class='arrow' alt='filter icon'>
        <img *ngIf='!!totalFilters' src='assets/img/icon-filter-gray-1.svg' class='arrow' [alt]='"filter icon with " + totalFilters + " filters active"'>
        <span>סינון</span>
        <div class='count' *ngIf='totalFilters'>{{totalFilters}}</div>
    </button>
</ng-container>
<ng-container *ngIf='active'>
    <div class='situations'>
        <div class='section' *ngIf='responseItems && responseItems.length'>
            <div class='section-header'>
                <!-- <div class='title' *ngIf='!searchParams.response'>סוגי שירות:</div>
                <div class='title' *ngIf='!!searchParams.response'>סוגי שירות נוספים:</div> -->
                <div class='title'>סוגי שירות:</div>
                <a class='clear' (activated)='currentSearchParams.filter_responses = []; pushSearchParams()' clickOnReturn role='button' aria-label="Clear service items filter">ניקוי</a>
            </div>
            <div class='tags responses'>
                <app-response *ngFor='let response of responseItems' 
                        [response]='response' 
                        [selected]='isResponseSelected(response)'
                        [link]='false'
                        [selectable]='true'
                        (clicked)='toggleResponse(response)'
                ></app-response>
            </div>
        </div>
        <div class='section' *ngIf='audiences && audiences.length'>
            <div class='section-header'>
                <div class='title'>קהלי יעד:</div>
                <!-- <div class='title' *ngIf='!searchParams.situation'>קהלי יעד:</div>
                <div class='title' *ngIf='!!searchParams.situation'>קהלי יעד נוספים:</div> -->
                <a class='clear' (activated)='currentSearchParams.filter_situations = []; pushSearchParams()' clickOnReturn role='button' aria-label="Clear target audiences filter">ניקוי</a>
            </div>
            <div class='tags'>
                <div *ngFor='let situation of audiences'>
                    <app-search-filter-checkbox
                        [item]='situation'
                        [current]='currentSearchParams.filter_situations || []'
                        (changed)='onSituationChange($event, situation, "filter_situations")'
                    ></app-search-filter-checkbox>
                </div>
            </div>
        </div>
        <div class='section' *ngIf='age_groups && age_groups.length'>
            <div class='section-header'>
                <div class='title'>קבוצות גיל:</div>
                <a class='clear' (activated)='currentSearchParams.filter_age_groups = []; pushSearchParams()' clickOnReturn role='button' aria-label="Clear age group filter">ניקוי</a>
            </div>
            <div class='tags vertical'>
                <div *ngFor='let situation of age_groups'>
                    <app-search-filter-checkbox
                        [item]='situation'
                        [current]='currentSearchParams.filter_age_groups || []'
                        (changed)='onSituationChange($event, situation, "filter_age_groups")'
                    ></app-search-filter-checkbox>
                </div>
            </div>
        </div>
        <div class='section' *ngIf='languages && languages.length'>
            <div class='section-header'>
                <div class='title'>לדוברי שפות (שאינן עברית):</div>
                <a class='clear' (activated)='currentSearchParams.filter_languages = []; pushSearchParams()' clickOnReturn role='button' aria-label="Clear languages filter">ניקוי</a>
            </div>
            <div class='tags'>
                <div *ngFor='let situation of languages'>
                    <app-search-filter-checkbox
                        [item]='situation'
                        [current]='currentSearchParams.filter_languages || []'
                        (changed)='onSituationChange($event, situation, "filter_languages")'
                    ></app-search-filter-checkbox>
                </div>
            </div>
        </div>
    </div>
    <div class='submit'>
        <button class='main' (click)='closeWithParams()'>
            <img src='assets/img/icon-filter-gray-1.svg' class='arrow'>
            <strong>הפעל סינון</strong>&nbsp;
            <span *ngIf='resultCount > 1'>({{resultCount}} תוצאות)</span>
            <span *ngIf='resultCount === 1'>(תוצאה אחת)</span>
            <span *ngIf='resultCount === 0'>(אין תוצאות)</span>
            <div class='count' *ngIf='totalFilters'>{{totalFilters}}</div>
        </button>
        <a class='cancel' (activated)='clear()' *ngIf='totalFilters' clickOnReturn role='button' aria-label="Clear all filters">
            ניקוי
        </a>
        <a class='cancel' (activated)='clear()' *ngIf='!totalFilters' clickOnReturn role='button' aria-label="Close filtering dialog">
            ביטול
        </a>
    </div>
</ng-container>
